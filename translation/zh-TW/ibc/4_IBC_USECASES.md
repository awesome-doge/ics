# 4：IBC 用例

**這是區塊鏈間通信協議的一組可能的應用層用例。**

**有關 IBC 規範中使用的術語的定義，請參見[此處](./1_IBC_TERMINOLOGY.md) 。**

**有關架構的概述，請參見[此處](./2_IBC_ARCHITECTURE.md) 。**

**有關廣泛的協議設計原則，請參見[此處](./3_IBC_DESIGN_PRINCIPLES.md) 。**

**有關設計模式的討論，請參見[此處](./5_IBC_DESIGN_PATTERNS.md) 。**

這是區塊鏈間通信協議（IBC）可能的具體應用用例的詳盡清單，在此列出的目的是為了啟發並意圖提供靈感和一些視角，以從這些角度評估設計協議。

對於每個用例，我們定義相關鏈的要求，高層次封包處理邏輯，在相關鏈的組合狀態視圖中維護的應用程式屬性以及潛在相關區域的不同對比優勢或應用程式特性的列表。

## 資產轉移

只要存在相容的原生資產表示形式，IBC 即可用於在兩個鏈之間轉移資產。

### 同質化通證

IBC 可用於在鏈之間轉移同質化通證。

#### 表現形式

比特幣`UTXO` ，以太坊`ERC20` ，Cosmos SDK `sdk.Coins` 。

#### 實現

兩條鏈選擇相互“錨定”兩個語義相容的同質化通證面額，在發送和處理 IBC 封包時根據需要進行託管，取消託管，鑄造和銷毀。

可能存在一個起始“源區域”，該區域起始時就擁有全部的通證數量，而“目標區域”起始時通證餘額為零，或者兩個區域起始時通證餘額都不為零（也許來自於第三方擁有通證的區域），或者兩個區域可以選擇合併供應並提供兩個和以前完全不同的通證作為替代。

#### 不變數

在所有錨定表示形式中任何數量的通證都具有同質性，在整個鏈中累積的總供給是恆定的（或對於通貨膨脹資產而言是公式化的），並且通證同一時刻只能以一種可消費的形式存在於一個鏈上。

### 非同質化通證

IBC 可用於在鏈之間轉移非同質化通證。

#### 表現形式

以太坊`ERC721` ，Cosmos SDK `sdk.NFT` 。

#### 實現

兩條鏈選擇相互“錨定”兩個語義相容的非同質化通證名稱空間，在發送和處理 IBC 封包時根據需要進行託管，取消託管，創建和銷毀。

可能有一個初始的擁有一些特定通證的“源區域”，並包含與通證相關的邏輯（例如，繁殖加密貓，兌換數字票證），或者可以將相關的邏輯與 NFT 一起打包為所有相關鏈都能理解的格式。

#### 不變數

任何給定的非同質化通證在任何時間點都唯一的存在於一條鏈上的一個特定帳戶裡，並且在需要時，始終可以轉移回“源”區域以執行關聯的操作（例如，繁殖加密貓）。

### 涉及區域

#### 原生支付

諸如 Cosmos Hub 之類的“原生支付”區域可以允許通過 IBC 進行傳入和傳出同質化或/和非同質化通證。由於高安全性或高連接性，用戶可能選擇將資產保留在此類區域中。

#### 屏蔽支付

一個屏蔽支付區域，例如 Zcash 區塊鏈（待處理的 [UIT](https://github.com/zcash/zcash/issues/830) ）可以允許通過 IBC 進行傳入和傳出同質化或/和非同質化通證。然後，可以通過零知識流程保護轉移到此類區域的通證，並對其進行持有，轉移，交易等。一旦用戶完成了要求匿名的目的，就可以將其轉移出去，並通過 IBC 轉移回其他區域。

#### 去中心化交易所

“去中心化交易所”區域可以允許通過 IBC 進行傳入和傳出同質化或/和非同質化通證，並允許通過類 Uniswap 或 0x（或未來的此類協議）的去中心交易協議來交易存儲在該區域上的通證。

#### 去中心化金融

以太坊區塊鏈等“去中心化金融”區域可以允許通過 IBC 進行傳入和傳出同質化或/和非同質化通證，並允許存儲在該區域中的通證與多種去中心化金融產品進行交互：合成穩定幣，抵押貸款，流動性資金池等。

## 多鏈合約

IBC 可用於在分布在多個鏈中的合約邏輯之間傳遞消息和數據。

### 跨鏈合約調用

IBC 可用於在獨立的智慧合約平台鏈之間執行任意帶有調用數據和返回數據的合約調用。

#### 表現形式

合約：以太坊 `EVM` ， `WASM` （各種），Tezos `Michelson` ，Agoric `Jessie` 。

調用數據：以太坊`ABI` ，通用序列化格式，例如 RLP，Protobuf 或 JSON。

#### 實現

一個合約如果打算調用另一個區域上的合約，必須在 IBC 封包中序列化目標合約的調用數據和地址，該數據可以通過 IBC 連接中繼到目標鏈上的 IBC 處理程序，該 IBC 處理程序將調用指定的合約，執行任何關聯的邏輯，然後將調用結果（如果適用）包含到第二個 IBC 封包中，返回給調用合約，該合約需要非同步處理。

實現鏈時可以選擇為合約開發人員提供“通道”對象，包括發送端，接收端，可配置的緩衝區大小等，這與使用 Go 或 Haskell 等語言進行的多進程並發編程中的通道非常相似。

#### 不變數

因合約而異。

### 跨鏈費用支付

#### 表現形式

與上述“同質化通證”相同。

#### 實現

使用一個鏈上持有的資產支付另一條鏈上的費用，可以透過將通證發送到第二條鏈的驗證人集合控制的第一條鏈上的帳戶上，並包含通證已發送（在第一條鏈上）的證明，一起在交易中提交給第二條鏈的方式實現。

資金可以定期通過 IBC 連接從第一條鏈發送回第二條鏈，以進行費用支付。

#### 不變數

只在其中一條鏈上支付正確的費用，不能同時在兩條鏈上。

### 跨鏈抵押

一條鏈上的驗證人集合的子集可以選擇驗證另一條鏈，並對通過 IBC 連接處理提交的該鏈產生的矛盾行為，第二條鏈可以通過同一 IBC 連接將其驗證人更新邏輯委託給第一條鏈。

#### 表現形式

ABCI `Evidence`和`ValidatorUpdate` 。

#### 實現

主（抵押）鏈通過 IBC 封包將包含驗證人集合的參與子集的`ValidatorUpdate`中繼到被抵押鏈，被抵押鏈直接使用它們設置自己的驗證人集合。

任何矛盾行為都通過`Evidence`從被抵押鏈傳回了主鏈，從而可以懲罰引起矛盾行為的驗證人。

#### 不變數

犯有矛盾行為的驗證人在至少一條鏈上是可以被懲罰的，並且可以將被抵押鏈的驗證人集合綁定到主（抵押）鏈的驗證人集合上。

## 分片

IBC 可以在具有相互理解的虛擬機和數據格式的區塊鏈之間遷移智慧合約和數據。

### 代碼遷移

#### 表現形式

與上面的“跨鏈合約調用”相同，另外要求所有涉及的代碼必須是可序列化的，並且在所涉及的鏈上可以相互理解（可執行）。

#### 實現

參與分片的鏈通過已知的平衡（“分片”）算法，在鏈之間遷移它們都可以執行的合約，這些算法可能旨在均衡負載或使局部頻繁交互合約更加高效。

需要一個在核心 IBC 之上的路由系統來正確路由可能頻繁切換鏈的合約之間的跨鏈調用。

#### 不變數

保留代碼的語義，透過某種路由系統保留命名空間。

### 數據遷移

IBC 可用於實施任意深度的多鏈“快取”系統，在該系統中，存儲成本可以轉變為訪問成本。

#### 表現形式

通用序列化格式，例如 Amino，RLP，Protobuf，JSON。

#### 實現

一個任意深度的 IBC 連接鍊表鏈，其中第一個鏈針對計算進行最佳化，後來的鏈針對存儲成本進行最佳化，就可以實現分層快取，其中任何一條鏈上一段時間未使用的數據都將遷移到列表中的下一個鏈。當需要數據時（例如，用於合約調用或存儲訪問），如果在鏈中沒有查找到，則必須通過 IBC 封包將其中繼回該鏈（然後可以將其重新快取一段時間 ）。

#### 不變數

當請求時，所有數據都可以在主（計算）鏈上訪問到，並具有一個 IBC 跳數的已知邊界。
